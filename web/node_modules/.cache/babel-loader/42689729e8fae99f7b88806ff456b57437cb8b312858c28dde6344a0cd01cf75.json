{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { captchaApi } from '../../api/modules/auth';\nexport default {\n  data() {\n    return {\n      captcha: {\n        uuid: '',\n        data: ''\n      },\n      form: {\n        roleType: 'student',\n        username: '',\n        password: '',\n        captchaType: 'image',\n        captchaUuid: '',\n        captchaInput: '',\n        type: 2,\n        role: 2,\n        projectCode: 'ljj'\n      }\n    };\n  },\n  created() {\n    this.loadCaptcha();\n  },\n  methods: {\n    async loadCaptcha() {\n      const r = await captchaApi('image');\n      if (r.code === 200) {\n        this.captcha = r.data;\n        this.form.captchaUuid = r.data.uuid;\n      }\n    },\n    async submit() {\n      const roleMap = {\n        student: {\n          role: 2,\n          type: 2\n        },\n        monitor: {\n          role: 4,\n          type: 2\n        },\n        admin: {\n          role: null,\n          type: null\n        }\n      };\n      Object.assign(this.form, roleMap[this.form.roleType]);\n      const r = await this.$store.dispatch('auth/login', this.form);\n      if (r.code === 200) {\n        const role = this.form.roleType === 'admin' ? 'admin' : r.data.user.role;\n        const map = {\n          student: '/student/dashboard',\n          monitor: '/student/dashboard',\n          admin: '/admin/dashboard'\n        };\n        this.$router.push(map[role]);\n      } else {\n        this.$message.error(r.message);\n        this.loadCaptcha();\n      }\n    }\n  }\n};","map":{"version":3,"names":["captchaApi","data","captcha","uuid","form","roleType","username","password","captchaType","captchaUuid","captchaInput","type","role","projectCode","created","loadCaptcha","methods","r","code","submit","roleMap","student","monitor","admin","Object","assign","$store","dispatch","user","map","$router","push","$message","error","message"],"sources":["src/views/auth/Login.vue"],"sourcesContent":["<template>\n  <div class=\"auth-wrap\">\n    <div class=\"auth-card auth-card-login\">\n      <div class=\"auth-title\">云同学录登录</div>\n      <p class=\"auth-subtitle\">学生 / 班长(班主任) / 管理员</p>\n\n      <div class=\"form-grid\">\n        <select v-model=\"form.roleType\">\n          <option value=\"student\">学生</option>\n          <option value=\"monitor\">班长/班主任</option>\n          <option value=\"admin\">管理员</option>\n        </select>\n        <input v-model=\"form.username\" placeholder=\"请输入账号\" />\n        <input v-model=\"form.password\" type=\"password\" placeholder=\"请输入密码\" />\n\n        <div class=\"captcha-row\">\n          <input v-model=\"form.captchaInput\" placeholder=\"请输入验证码\" />\n          <img v-if=\"captcha.data\" :src=\"`data:image/png;base64,${captcha.data}`\" class=\"captcha-img\" @click=\"loadCaptcha\" />\n          <button class=\"chip\" @click=\"loadCaptcha\">换一张</button>\n        </div>\n      </div>\n\n      <div class=\"auth-actions\">\n        <button @click=\"submit\">立即登录</button>\n        <router-link to=\"/register\" class=\"chip\">没有账号？去注册</router-link>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { captchaApi } from '../../api/modules/auth'\n\nexport default {\n  data() {\n    return {\n      captcha: { uuid: '', data: '' },\n      form: {\n        roleType: 'student',\n        username: '',\n        password: '',\n        captchaType: 'image',\n        captchaUuid: '',\n        captchaInput: '',\n        type: 2,\n        role: 2,\n        projectCode: 'ljj'\n      }\n    }\n  },\n  created() {\n    this.loadCaptcha()\n  },\n  methods: {\n    async loadCaptcha() {\n      const r = await captchaApi('image')\n      if (r.code === 200) {\n        this.captcha = r.data\n        this.form.captchaUuid = r.data.uuid\n      }\n    },\n    async submit() {\n      const roleMap = {\n        student: { role: 2, type: 2 },\n        monitor: { role: 4, type: 2 },\n        admin: { role: null, type: null }\n      }\n      Object.assign(this.form, roleMap[this.form.roleType])\n      const r = await this.$store.dispatch('auth/login', this.form)\n      if (r.code === 200) {\n        const role = this.form.roleType === 'admin' ? 'admin' : r.data.user.role\n        const map = { student: '/student/dashboard', monitor: '/student/dashboard', admin: '/admin/dashboard' }\n        this.$router.push(map[role])\n      } else {\n        this.$message.error(r.message)\n        this.loadCaptcha()\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.auth-card-login { max-width: 680px; }\n.form-grid { display: grid; gap: 10px; margin: 14px 0; }\n.captcha-row { display: grid; grid-template-columns: 1fr 110px auto; gap: 8px; align-items: center; }\n.captcha-img { width: 110px; height: 42px; object-fit: cover; border-radius: 8px; border: 1px solid #f0d8a6; cursor: pointer; }\n</style>\n"],"mappings":";AA+BA,SAAAA,UAAA;AAEA;EACAC,KAAA;IACA;MACAC,OAAA;QAAAC,IAAA;QAAAF,IAAA;MAAA;MACAG,IAAA;QACAC,QAAA;QACAC,QAAA;QACAC,QAAA;QACAC,WAAA;QACAC,WAAA;QACAC,YAAA;QACAC,IAAA;QACAC,IAAA;QACAC,WAAA;MACA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,WAAA;EACA;EACAC,OAAA;IACA,MAAAD,YAAA;MACA,MAAAE,CAAA,SAAAjB,UAAA;MACA,IAAAiB,CAAA,CAAAC,IAAA;QACA,KAAAhB,OAAA,GAAAe,CAAA,CAAAhB,IAAA;QACA,KAAAG,IAAA,CAAAK,WAAA,GAAAQ,CAAA,CAAAhB,IAAA,CAAAE,IAAA;MACA;IACA;IACA,MAAAgB,OAAA;MACA,MAAAC,OAAA;QACAC,OAAA;UAAAT,IAAA;UAAAD,IAAA;QAAA;QACAW,OAAA;UAAAV,IAAA;UAAAD,IAAA;QAAA;QACAY,KAAA;UAAAX,IAAA;UAAAD,IAAA;QAAA;MACA;MACAa,MAAA,CAAAC,MAAA,MAAArB,IAAA,EAAAgB,OAAA,MAAAhB,IAAA,CAAAC,QAAA;MACA,MAAAY,CAAA,cAAAS,MAAA,CAAAC,QAAA,oBAAAvB,IAAA;MACA,IAAAa,CAAA,CAAAC,IAAA;QACA,MAAAN,IAAA,QAAAR,IAAA,CAAAC,QAAA,yBAAAY,CAAA,CAAAhB,IAAA,CAAA2B,IAAA,CAAAhB,IAAA;QACA,MAAAiB,GAAA;UAAAR,OAAA;UAAAC,OAAA;UAAAC,KAAA;QAAA;QACA,KAAAO,OAAA,CAAAC,IAAA,CAAAF,GAAA,CAAAjB,IAAA;MACA;QACA,KAAAoB,QAAA,CAAAC,KAAA,CAAAhB,CAAA,CAAAiB,OAAA;QACA,KAAAnB,WAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}