{"ast":null,"code":"import \"core-js/modules/es.json.parse.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport { loginApi, registerApi, adminLoginApi } from '../../api/modules/auth';\nconst state = {\n  token: localStorage.getItem('token') || '',\n  user: JSON.parse(localStorage.getItem('user') || 'null')\n};\nconst mutations = {\n  setAuth(s, p) {\n    s.token = p.token;\n    s.user = p.user;\n    localStorage.setItem('token', p.token);\n    localStorage.setItem('user', JSON.stringify(p.user));\n  },\n  logout(s) {\n    s.token = '';\n    s.user = null;\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n  }\n};\nconst actions = {\n  async login({\n    commit\n  }, form) {\n    const api = form.roleType === 'admin' ? adminLoginApi : loginApi;\n    const payload = {\n      ...form\n    };\n    delete payload.roleType;\n    const r = await api(payload);\n    if (r.code === 200) {\n      if (form.roleType === 'admin') {\n        const adminUser = {\n          username: form.username,\n          role: 'admin',\n          nickname: '管理员'\n        };\n        commit('setAuth', {\n          token: `admin-${Date.now()}`,\n          user: adminUser\n        });\n      } else {\n        commit('setAuth', r.data);\n      }\n    }\n    return r;\n  },\n  async register({\n    commit\n  }, form) {\n    const r = await registerApi(form);\n    if (r.code === 200) commit('setAuth', r.data);\n    return r;\n  }\n};\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n};","map":{"version":3,"names":["loginApi","registerApi","adminLoginApi","state","token","localStorage","getItem","user","JSON","parse","mutations","setAuth","s","p","setItem","stringify","logout","removeItem","actions","login","commit","form","api","roleType","payload","r","code","adminUser","username","role","nickname","Date","now","data","register","namespaced"],"sources":["/home/skyissky/skyissky/BYSJ/ljj/web/src/store/modules/auth.js"],"sourcesContent":["import { loginApi, registerApi, adminLoginApi } from '../../api/modules/auth'\n\nconst state = {\n  token: localStorage.getItem('token') || '',\n  user: JSON.parse(localStorage.getItem('user') || 'null')\n}\n\nconst mutations = {\n  setAuth(s, p) {\n    s.token = p.token\n    s.user = p.user\n    localStorage.setItem('token', p.token)\n    localStorage.setItem('user', JSON.stringify(p.user))\n  },\n  logout(s) {\n    s.token = ''\n    s.user = null\n    localStorage.removeItem('token')\n    localStorage.removeItem('user')\n  }\n}\n\nconst actions = {\n  async login({ commit }, form) {\n    const api = form.roleType === 'admin' ? adminLoginApi : loginApi\n    const payload = { ...form }\n    delete payload.roleType\n    const r = await api(payload)\n    if (r.code === 200) {\n      if (form.roleType === 'admin') {\n        const adminUser = { username: form.username, role: 'admin', nickname: '管理员' }\n        commit('setAuth', { token: `admin-${Date.now()}`, user: adminUser })\n      } else {\n        commit('setAuth', r.data)\n      }\n    }\n    return r\n  },\n  async register({ commit }, form) {\n    const r = await registerApi(form)\n    if (r.code === 200) commit('setAuth', r.data)\n    return r\n  }\n}\n\nexport default { namespaced: true, state, mutations, actions }\n"],"mappings":";;AAAA,SAASA,QAAQ,EAAEC,WAAW,EAAEC,aAAa,QAAQ,wBAAwB;AAE7E,MAAMC,KAAK,GAAG;EACZC,KAAK,EAAEC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE;EAC1CC,IAAI,EAAEC,IAAI,CAACC,KAAK,CAACJ,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,IAAI,MAAM;AACzD,CAAC;AAED,MAAMI,SAAS,GAAG;EAChBC,OAAOA,CAACC,CAAC,EAAEC,CAAC,EAAE;IACZD,CAAC,CAACR,KAAK,GAAGS,CAAC,CAACT,KAAK;IACjBQ,CAAC,CAACL,IAAI,GAAGM,CAAC,CAACN,IAAI;IACfF,YAAY,CAACS,OAAO,CAAC,OAAO,EAAED,CAAC,CAACT,KAAK,CAAC;IACtCC,YAAY,CAACS,OAAO,CAAC,MAAM,EAAEN,IAAI,CAACO,SAAS,CAACF,CAAC,CAACN,IAAI,CAAC,CAAC;EACtD,CAAC;EACDS,MAAMA,CAACJ,CAAC,EAAE;IACRA,CAAC,CAACR,KAAK,GAAG,EAAE;IACZQ,CAAC,CAACL,IAAI,GAAG,IAAI;IACbF,YAAY,CAACY,UAAU,CAAC,OAAO,CAAC;IAChCZ,YAAY,CAACY,UAAU,CAAC,MAAM,CAAC;EACjC;AACF,CAAC;AAED,MAAMC,OAAO,GAAG;EACd,MAAMC,KAAKA,CAAC;IAAEC;EAAO,CAAC,EAAEC,IAAI,EAAE;IAC5B,MAAMC,GAAG,GAAGD,IAAI,CAACE,QAAQ,KAAK,OAAO,GAAGrB,aAAa,GAAGF,QAAQ;IAChE,MAAMwB,OAAO,GAAG;MAAE,GAAGH;IAAK,CAAC;IAC3B,OAAOG,OAAO,CAACD,QAAQ;IACvB,MAAME,CAAC,GAAG,MAAMH,GAAG,CAACE,OAAO,CAAC;IAC5B,IAAIC,CAAC,CAACC,IAAI,KAAK,GAAG,EAAE;MAClB,IAAIL,IAAI,CAACE,QAAQ,KAAK,OAAO,EAAE;QAC7B,MAAMI,SAAS,GAAG;UAAEC,QAAQ,EAAEP,IAAI,CAACO,QAAQ;UAAEC,IAAI,EAAE,OAAO;UAAEC,QAAQ,EAAE;QAAM,CAAC;QAC7EV,MAAM,CAAC,SAAS,EAAE;UAAEhB,KAAK,EAAE,SAAS2B,IAAI,CAACC,GAAG,CAAC,CAAC,EAAE;UAAEzB,IAAI,EAAEoB;QAAU,CAAC,CAAC;MACtE,CAAC,MAAM;QACLP,MAAM,CAAC,SAAS,EAAEK,CAAC,CAACQ,IAAI,CAAC;MAC3B;IACF;IACA,OAAOR,CAAC;EACV,CAAC;EACD,MAAMS,QAAQA,CAAC;IAAEd;EAAO,CAAC,EAAEC,IAAI,EAAE;IAC/B,MAAMI,CAAC,GAAG,MAAMxB,WAAW,CAACoB,IAAI,CAAC;IACjC,IAAII,CAAC,CAACC,IAAI,KAAK,GAAG,EAAEN,MAAM,CAAC,SAAS,EAAEK,CAAC,CAACQ,IAAI,CAAC;IAC7C,OAAOR,CAAC;EACV;AACF,CAAC;AAED,eAAe;EAAEU,UAAU,EAAE,IAAI;EAAEhC,KAAK;EAAEO,SAAS;EAAEQ;AAAQ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}