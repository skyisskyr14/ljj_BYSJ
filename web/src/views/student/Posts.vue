<template><div><PageHeader title="åŠ¨æ€å¹¿åœº" desc="å‘å¸ƒã€ç‚¹èµã€è¯„è®º"/><div class="card"><textarea v-model="content" placeholder="è¯´ç‚¹ä»€ä¹ˆ"/><button @click="pub">å‘å¸ƒ</button></div><div class="card" v-for="p in posts" :key="p.id"><p>{{p.content}}</p><small>{{p.status}}</small><div><button @click="like(p)">ğŸ‘ {{p.likes.length}}</button><input v-model="comment[p.id]" placeholder="è¯„è®º"/><button @click="sendComment(p)">å‘é€</button></div><ul><li v-for="c in p.comments" :key="c.id">{{c.text}}</li></ul></div></div></template><script>import PageHeader from '../../components/PageHeader.vue';import { postListApi,createPostApi,likePostApi,commentPostApi } from '../../api/modules/post';export default{components:{PageHeader},data(){return{posts:[],content:'',comment:{}}},methods:{async load(){this.posts=(await postListApi()).data},async pub(){const u=this.$store.state.auth.user;await createPostApi({classId:'c1',userId:u.id,content:this.content,images:[]});this.content='';this.load()},async like(p){const u=this.$store.state.auth.user;await likePostApi({id:p.id,userId:u.id});this.load()},async sendComment(p){const u=this.$store.state.auth.user;await commentPostApi({id:p.id,comment:{userId:u.id,text:this.comment[p.id],replyTo:null}});this.comment[p.id]='';this.load()}},mounted(){this.load()}}</script>